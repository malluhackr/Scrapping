# 1. അടിസ്ഥാനമായി ഒരു പൈത്തൺ ഇമേജ് തിരഞ്ഞെടുക്കുന്നു
FROM python:3.13-slim

# 2. ആപ്ലിക്കേഷന് വേണ്ടി ഒരു വർക്കിംഗ് ഡയറക്ടറി സെറ്റ് ചെയ്യുന്നു
WORKDIR /app

# 3. requirements.txt ഫയൽ കോപ്പി ചെയ്യുന്നു
COPY requirements.txt .

# 4. പൈത്തൺ പാക്കേജുകൾ ഇൻസ്റ്റാൾ ചെയ്യുന്നു
RUN pip install --no-cache-dir -r requirements.txt

# 5. Playwright-ന് ആവശ്യമായ ബ്രൗസർ ഇൻസ്റ്റാൾ ചെയ്യുന്നു (പ്രധാനപ്പെട്ട ഭാഗം)
RUN python -m playwright install --with-deps firefox

# 6. പ്രോജക്റ്റിലെ ബാക്കി എല്ലാ ഫയലുകളും കോപ്പി ചെയ്യുന്നു
COPY . .

# 7. ആപ്ലിക്കേഷൻ പ്രവർത്തിക്കുന്ന പോർട്ട് ഏതാണെന്ന് مشخصമാക്കുന്നു
EXPOSE 8000

# 8. ആപ്ലിക്കേഷൻ പ്രവർത്തിപ്പിക്കാനുള്ള കമാൻഡ്
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]
